<!--
Author: W3layouts
Author URL: https://w3layouts.com/entrar-shadow-flat-form-template/
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html>
<html>
<head>
        <meta charset="utf-8">
    <title>BibAdmin Login</title>
        <link rel="stylesheet" type="text/css" href="vendor/ng-admin.min.css"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <h1>BibAdmin Login</h1>
    <div class="container">
        <form  class="form-signin" role="form" onSubmit="return login()" method="post">
            <div class="form-group">
                <label class="control-label" for="username">Login</label>
                <input id="username" class="form-control input-lg" name="username" type="text" required="true">
            </div>
            <div class="form-group">
                <label class="control-label" for="password">Mot de passe</label>
                <input id="password" class="form-control input-lg" name="password" type="password" required="true">
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary btn-lg btn-block">Se connecter</button>
            </div>
        </form>
    </div>
    <script src="vendor/fetch.js"></script>
    <script>
    function login(e) {
        if (e) {
            e.prevenDefault();
        }

        fetch('http://localhost:3000/admin/login', {
            method: 'post',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                username: document.getElementById('username').value,
                password: document.getElementById('password').value,
            })
        }).then(function(response) {
            if (response.status === 401) {
                window.location.href = "./unauthorized.html";
            }
            return response.json();
        })
        .then(function (response) {
            window.sessionStorage.setItem('token', response.token);
            window.location.href = "./index.html";
        });

        return false;
    }
    </script>
</body>
</html>
